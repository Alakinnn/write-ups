```shell-session
alakin2504@htb[/htb]$ crunch <minimum length> <maximum length> <charset> -t <pattern> -o <output file>
```

The "`-t`" option is used to specify the pattern for generated passwords. The pattern can contain "`@`," representing lower case characters, "`,`" (comma) will insert upper case characters, "`%`" will insert numbers, and "`^`" will insert symbols.

```shell-session
alakin2504@htb[/htb]$ crunch 4 8 -o wordlist
```
The command above creates a wordlist consisting of words with a length of 4 to 8 characters, using the default character set.


```shell-session
alakin2504@htb[/htb]$ crunch 17 17 -t ILFREIGHT201%@@@@ -o wordlist
```
Let's assume that Inlane Freight user passwords are of the form "`ILFREIGHTYYYYXXXX`," where "`XXXX`" is the employee ID containing letters, and "`YYYY`" is the year. We can use `crunch` to create a list of such passwords.

The pattern "`ILFREIGHT201%@@@@`" will create words with the years 2010-2019 followed by four letters. The length here is 17, which is constant for all words.

If we know a user's birthdate is 10/03/1998 (through social media, etc.), we can include this in their password, followed by a string of letters. Crunch can be used to create a wordlist of such words. The "`-d`" option is used to specify the amount of repetition.

#### Crunch - Specified Repetition


```shell-session
alakin2504@htb[/htb]$ crunch 12 12 -t 10031998@@@@ -d 1 -o wordlist
```

`CUPP` stands for `Common User Password Profiler`, and is used to create highly targeted and customized wordlists based on information gained from social engineering and OSINT. People tend to use personal information while creating passwords, such as phone numbers, pet names, birth dates, etc. CUPP takes in this information and creates passwords from them. These wordlists are mostly used to gain access to social media accounts. CUPP is installed by default on Parrot OS, and the repo can be found [here](https://github.com/Mebus/cupp). The "`-i`" option is used to run in interactive mode, prompting `CUPP` to ask us for information on the target.

#### CUPP - Usage Example

```shell-session
alakin2504@htb[/htb]$ python3 cupp.py -i

[+] Insert the information about the victim to make a dictionary
[+] If you don't know all the info, just hit enter when asked! ;)

> First Name: roger
> Surname: penrose
> Nickname:      
> Birthdate (DDMMYYYY): 11051972
```

## KWPROCESSOR

`Kwprocessor` is a tool that creates wordlists with keyboard walks. Another common password generation technique is to follow patterns on the keyboard. These passwords are called keyboard walks, as they look like a walk along the keys. For example, the string "`qwertyasdfg`" is created by using the first five characters from the keyboard's first two rows. This seems complex to the normal eye but can be easily predicted. `Kwprocessor` uses various algorithms to guess patterns such as these.

The tool can be found [here](https://github.com/hashcat/kwprocessor) and has to be installed manually.

## Princeprocessor

`PRINCE` or `PRobability INfinite Chained Elements` is an efficient password guessing algorithm to improve password cracking rates. [Princeprocessor](https://github.com/hashcat/princeprocessor) is a tool that generates passwords using the PRINCE algorithm. The program takes in a wordlist and creates chains of words taken from this wordlist. For example, if a wordlist contains the words:

```shell-session
alakin2504@htb[/htb]$ ./pp64.bin --pw-min=10 --pw-max=25 -o wordlist.txt < words
```

## CeWL

[CeWL](https://github.com/digininja/CeWL) is another tool that can be used to create custom wordlists. It spiders and scrapes a website and creates a list of the words that are present. This kind of wordlist is effective, as people tend to use passwords associated with the content they write or operate on. For example, a blogger who blogs about nature, wildlife, etc. could have a password associated with those topics. This is due to human nature, as such passwords are also easy to remember. Organizations often have passwords associated with their branding and industry-specific vocabulary. For example, users of a networking company may have passwords consisting of words like `router`, `switch`, `server`, and so on. Such words can be found on their websites under blogs, testimonials, and product descriptions.

The general syntax of `CeWL` is as follows:

#### CeWL - Syntax

```shell-session
alakin2504@htb[/htb]$ cewl -d <depth to spider> -m <minimum word length> -w <output wordlist> <url of website>
```

CeWL can spider multiple pages present on a given website. The length of the outputted words can be altered using the "`-m`" parameter, depending on the password requirements (i.e., some websites have a minimum password length).

CeWL also supports the extraction of emails from websites with the "`-e`" option. It's helpful to get this information when phishing, password spraying, or brute-forcing passwords later.

#### CeWL - Example


```shell-session
alakin2504@htb[/htb]$ cewl -d 5 -m 8 -e http://inlanefreight.com/blog -w wordlist.txt
```

The command above scrapes up to a depth of five pages from "`http://inlanefreight.com/blog`", and includes only words greater than 8 in length.

---

## Previously Cracked Passwords

By default, hashcat stores all cracked passwords in the `hashcat.potfile` file; the format is `hash:password`. The main purpose of this file is to remove previously cracked hashes from the work log and display cracked passwords with the `--show` command. However, it can be used to create new wordlists of previously cracked passwords, and when combined with rule files, it can prove quite effective at cracking themed passwords.

```shell-session
alakin2504@htb[/htb]$ cut -d: -f 2- ~/hashcat.potfile
```

---

## Hashcat-utils

The Hashcat-utils [repo](https://github.com/hashcat/hashcat-utils) contains many utilities that can be useful for more advanced password cracking. The tool [maskprocessor](https://github.com/hashcat/maskprocessor), for example, can be used to create wordlists using a given mask. Detailed usage for this tool can be found [here](https://hashcat.net/wiki/doku.php?id=maskprocessor).

For example, `maskprocessor` can be used to append all special characters to the end of a word:

```shell-session
alakin2504@htb[/htb]$ /mp64.bin Welcome?s
Welcome 
Welcome!
Welcome"
Welcome#
Welcome$
Welcome%
Welcome&
Welcome'
Welcome(
Welcome)
Welcome*
Welcome+

<SNIP>
```

 [Previous](https://academy.hackthebox.com/module/20/section/122)