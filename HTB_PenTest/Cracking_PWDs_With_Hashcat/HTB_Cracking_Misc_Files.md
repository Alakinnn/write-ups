## Example 1 - Cracking Password Protected Microsoft Office Documents

`Hashcat` can be used to attempt to crack password hashes extracted from some Microsoft Office documents using the [office2john.py](https://raw.githubusercontent.com/magnumripper/JohnTheRipper/bleeding-jumbo/run/office2john.py) tool.

`Hashcat` supports the following hash modes for Microsoft Office documents:

|**Mode**|**Target**|
|---|---|
|`9400`|MS Office 2007|
|`9500`|MS Office 2010|
|`9600`|MS Office 2013|

There are also several "`$oldoffice$`" hash modes for MS Office documents older than 2003. Let's take a Worddocument protected with the password "`pa55word`". We can first extract the hash from the document using `office2john.py`.

```shell-session
alakin2504@htb[/htb]$ python office2john.py hashcat_Word_example.docx 

hashcat_Word_example.docx:$office$*2013*100000*256*16*6e059661c3ed733f5730eaabb41da13a*aa38e007ee01c07e4fe95495934cf68f*2f1e2e9bf1f0b320172cd667e02ad6be1718585b6594691907b58191a6
```

We can then run the hash through `Hashcat` using mode `9600` and make short work of it with the `rockyou.txt` wordlist. This is a rather slow hash to crack and will take over 12 hours to run through the entire `rockyou.txt` wordlist on a single CPU. This will be much faster on a GPU or several GPUs but still much slower than other hashes such as `MD5` and `NTLM`. Luckily for us as penetration testers, users often select very weak passwords to password-protect their documents!

## Example 2 - Cracking Password Protected Zip Files

During an assessment, we may find an interesting zip file, but it is password protected! We can extract these hashes using the compiled version of the [zip2john](https://github.com/magnumripper/JohnTheRipper/blob/bleeding-jumbo/src/zip2john.c) tool. `Hashcat` supports a variety of compressed file formats such as:

|**Mode**|**Target**|
|---|---|
|`11600`|7-Zip|
|`13600`|WinZip|
|`17200`|PKZIP (Compressed)|
|`17210`|PKZIP (Uncompressed)|
|`17220`|PKZIP (Compressed Multi-File)|
|`17225`|PKZIP (Mixed Multi-File)|
|`17230`|PKZIP (Compressed Multi-File Checksum-Only)|
|`23001`|SecureZIP AES-128|
|`23002`|SecureZIP AES-192|
|`23003`|SecureZIP AES-256|

For our example, we can take any document and add it to a password protected zip file in Parrot using the following command:

#### Extract Hash
```shell-session
alakin2504@htb[/htb]$ zip2john ~/Desktop/HTB/Academy/Cracking\ with\ Hashcat/blueprints.zip 

ver 2.0 efh 5455 efh 7875 blueprints.zip/dummy.pdf PKZIP Encr: 2b chk, TS_chk, cmplen=12324, decmplen=13264, crc=7EB29321
blueprints.zip/dummy.pdf:$pkzip2$1*2*2*0*3024*33d0*7eb29321*0*43*8*3024*7eb2*69f2*d796c9cde7b7ed8d7b76c1efd12d222d2bfcc7a2e5a94b21a55c965c36c5875ea17ba1ca63d8164dc214c8845fa20fab19ab90287ced1d06dd577ec86fe0bc7d09407d06c33369ed0b9e40b12c399b79afd32a72170b67726f76db9090872aff5d1d6adc628e19fb074621e7b76a88cafbb866c8601d8464b642de8d85536e7dbac9e7fbc29be2b9d449d139a23739788b71ada0960faeb05bf4792f4b605f4153b25fc2fd360bdc41556af9ebd5f1861f3432abb84f745e7c223a1e9c9649a329337c11be4acef01ceff8ab29bd07cd2ae540743018751ea2ac7f8357189b70ab0c713775d217b3f0bd5be591378f85c91dff66cd0f9d277a22c346f3cb540c904a8a3cc77e918372417e241c1510dc1ca0887142206ce7d5cf6cc6f5f4c92df425f095333fd142376e0e87b85f71ce0c37c5099b770669463e4787ab379738c40df8f3421c27ec97f81411faca80ecd32b8b1556f86d86a90866139fac2421448730276aae0ad1586c0b591becdd7fbb759411f66bd7b542f3767be0ec7d1664fe65c28898b5a597fff8f178c49347147a7937f64c984ce7ea90325e082226439715acdfd95df9894d7e3a890d923844353613ff87fbfe978176a45b78bd64e439ea29ddc351edb2450e2f9af2e23f87a3b3a67af62a51f2d1bd3a535a4e831ef046cd01dd84dc979ddcff10cf1738afb8a6c77f37e46c2542c6cfc908a85932a74ee9728fd5adcafb336bfec71c4671f6d42de90a8d474af88a1774bd350bd3f56b20c45eb5cce0c8541167d863ee2d74fdb64f1bde532aa5c0a62d5877b54970d3ac56a0fbd8f2ac568196414767a4a3ca2516dc6aeb8413474bf97e12272c2c18f200600caf7c6bb58b6d42d01f9c13f48dc51913486d586c22a566992b4d111a7847b557fe1ccc55010f9dc9a62d1634b95f3b947bf573688a1fc5cb05c3a4a7a98043326c05e164b7f325d7139337b272562750b2fec49491c9241a25c8c0b61e8a2034e48bf0d0b56d43de8a3c908df1df798f0c9ea7b09aa44e6fdfbc4fb561b6e2548a9b6e91528cb14d269e1c2da9fe79e8f7a405a0a985db9da6b1656c8a94e3f5a29d4803354b4b601e9ed2578204b741c72a0266e0fd6b62e6f426caac7ea90188760ab75c93e43f93e7298fdf62505ad668caa21f0721fc4ff62d1b8d4b52bde5a336f0dbec60530d39a536139189ce436a3a80e560cff735a20f167426b4b95b0195c7198d330144a132e3dc44447d089cff7758e9d4ea68343f232f6b64a66974f5f47dd179c258c65e02474a403dd261b62756535f93ba88daba4a8bad51f1479be44bdabcbe25fe3a7bef0a158c42ffb89d90544352ae87118dc62c2e6c63bc8e4281822127207b5691c89056d825f84fca7335ad785344295f54652504bdc5d4d56cff94d27dc176a0726f672057996d08a4339fecc4d921cfc587a1f06e0f31d0f9b359cc09feac0f80584c05e2b61634387e702d8162ee60626605473837788a60e036f4432d4d777316efd6d89c40ef618bf3507cd0e632d6ad2e5f777013f99e708adcbc0a18a80f7a24a214e771a229faa1ec5f289d5f730b20e387b397bb10b1c0819ed8bdf4bed1edd1bee3c6c567c20f5a9506e316b631f5c302f54601d5b276fd722aa84942b8aaf9f6a29f8f6aa686533d296a4414426c023830a063f0fa74739b19618257ae5fec18f9d7ae222ca4d2703c604712625a7f737d3463eb258f21921f50f147bb65bfe9e8d2f7816d346ea363ed9ea1e06352d1369ebf6650cf4523c420cc89a5f5c5033d44699fac7472abe99177a9c8b72e08f4407255c88cf133207a999e7185a5e8555db3236fb5aebbf917e3eaf10faa7321d7d31c54e435cceb600d00dbfdbb55316cf3a4485a44df711a349468c176c8f5f395c4fcaba87bd99bf29d46507211a0a71d9586179575ff0df64e3296564f05d82f5bcf90316e669303119af8535f112334fca800189ccf2d0c886c12b33f723a58dfb40eec824e3fb7fd3775484fae42292fc22e1de241f0b0ed7c7ef5ffba4c5e8db1a85ff6a9242ff6ceac6be495aa8413a913042bd08b51a817bed4a280835390aea61611c1ed3cb3b0e923820bd7548c477db8f50dc7702c9ee65c5b082b5221dc71e812444c3f9f33092c184994e890f0604bce91a4147646216facf58c5206eb2c848f33fd922b4f13daca37af90e874b547b2ad2c5629b8bab40a5d16301ef21ccd32b795f2d0b87584def944af4f733e0314f99a3522995b1fb2cc117a652f063bcbef3e8c8b58b6ed1bc22f0249d9ff7a55dd446910992b06582ffce257fc3f72454cc85f7ed220285c440e5ffa1a7e1b989404df1b4540dec84185589929c453ad402071781201b2c5961e04586a1dca94be1ec1e23b87161a6809358b1ba5a008a8e577ba9fd13368a599a0a01f24be662c2defa3d6f302e9099e432c2df8d4c5aed8cf1613701364e70035257288d9188dc76602e994ab9f7c6949891b4b58f2f944d4c1b9c2f15ef2db58e1f0b687f6af5e5749febfe1ebd9921ef20cf7774c49a75bb1b9a5d63ca44b47cdaa17c28b8ad119ae62bdda99dea3de7bbaefc06339d006d7f64465f90f8160143a51e1683a668f02cf646995ac3786b5d0afdc022125c42046a07a9affc3146b69f496a3070cc536ef3165d1ebfd0c51c4fcfba7cb3c218d98df8c86c3bc8fabd0717af68244dab5acf1cf60ac76236261cd6966598d51ccbf160e83e667ad5c3c75f43b4874a7cfcd7c9aab1703bef256aa9cbd8df334df150af2d03ff10e664b409c34920b0f737b26d5d536bc74fbc814f771753aa8465ee422e087b4a8215843d7e206849130d8d7209dedf3acd0bb1e64557e5875d57bae8d51a243a8a253c597a4302fc1b7162ed888730e5f50f13f51ceaddb65bfa10ee15dc95fa2ca0c3f2c34bad9129e98144df6e9be3c1edead6a3d0e7e0c70fae70fea2fcd644bc172b064c85a35f3869b734b187ef69671688f1780b285648967abada2040098b3c6727a882dc43b591a716dc93c75e2c48d055a2269c4391332c8aee5d40466341dac0884dbdba7e056b1d900018452a79ad1177e23c15dce167c0017a24ab251a768a6cd15add944495292ff6e1f8819aba82dd3566803e2432e871f686899fcc21d166dfbf12c1dcbbf471136b3d6a72c34d8f153ef8e6f66730953dd2defb6bde7b51765119bd2122efec22d9597ae07ce2635ec78d5f36d7213378000b23fc7668a1d998007baf6032d5baa7e6d2e906eb91257afbf4695fa80b6bb84e089287fea77fa1b929da2ee7d22e573ed780240aacd0490467e456661644c1e054edb1ff1481de0be23b980cf97667f578e4f391f7cd46d05a85c5c267669bd7ff6912902e1d65875c35f656461fb6f9ce7cbdacf3e3ff85a746b058c1a35845e58096c1679eac222bb0f14267c7ff639f775d15ffe4eae62b6e8fcd2ecd8cc97bd0f6c69ec8887f3baf88955d4a573f366a2dfcf9db548c8027dc5bd27a2353ca2abadb1be6dec28fa19734e728442763344afe898c272cad9d74a8fb6c57097a492cf423c30ecc80552034e6debebfa8548a8ab077b1d250bdb623d2e949dceaa5a8bc3402dffb620919e12a6218ee91b4f285f83c51360662652053251e0fd0435860e288e75b2c54b5951352a3eded6fe41baeb15eb86e0348d5b8e17f83fe93149df67dc8210bd5b9a525df5106432d3d7ba30d4bc9ecb1ac79e48b91231e6e80cc5842d7952dd137fade27910abf4e12c1ee866cebf69bca099ae5486566953c03b2317bfc13e4f00a151a7d513879b4b23925b6092e0b47e5a5933cf54e49cb202433ee4430e077bd8fd67140294ae9b1dfb7f0d0f8cde2f9cebed93a171025d52f206da490c85c8e9451fb245a5d8662bcd0810ec9d8e62f45ab6fe4d0134330e0d478738663af87850cdeced224ede49b98ebdac1ff72d51b7bc19794e938134a6be071be031c8b529836b87226fbe47c5c77aa003e543538532fe55eac50a233e6fd1d257f7ef760094e2bf52f1a5007089421c864a6217c242387c40c1f284fa41629a661eb61434b1cbb7613751350f0db295a8af13984d9cca993c36af82ca9f2c56874595b7f286d9727134923bb043d658eb7d17d1fadb20771ee279b1fcbd340dcbac8691e8da0c803e915bf47d4e86eb6556b50cf5bf871f3088099822c13ec6968fcf601c71a54de35734acf0a021727cf48f5a3d9c0f2812d0ee27f09027d3a4ea6a833fd6a261923cc71802050a32c8af50a408b71404575363ce9ad3bb80717184cd402d332d81e1f72e23d385a768e8adf2f1babb4e62410c612d093f59c8fbbccf3b9b30e4fdf4b4c548f07df36b18dd28b54d722a4608a18ad6c25ac51947ddf5bd8146929c80f0fdfc56482fbabd299e893c34a58530ebb4240056060285b0a0113c8af89711873aa3f12c64a9fdd2da22d6d9392822d7ae1b2d0edb3c89474f7c4b370edb57db068b6cfd6feaa7f21cabfd7b6e6ffcaf7ca4d1c9f4edd8b1583c602ad289f3cdd2bf994f1fb3d7d8e5200c4ce7862a54b70fda797d5c8dc53aac533458b043ce1c9107f901e872402311d57b605ca2c45102283f53d58d2ec3902e71755fb047e3e31c30a567b19b8eb746d0983b26d6b8ba3cda34caefb5222bebd2a560d2f533526754187220de87247107668acf6cedda362e6bdad175c42134f726a38280ad363d8916001a8a44182dc90519c7159aa175cb3f9376e1d6f603709d8f44182e09b8de61bf09b8488e146697ac0712625098b2dca6e898e9091435a0194114e2459b9db82ec839e074d08902693226c73d7eafe29bae786a5861504aed975290296507139bedba8b0d2617cb87366ebe4a62226dc4c91eab604532ac2b8614287740f910cce0a84f4d592d65f51c1a5356b1668dcce80afe49dbd92b408d3d33a67db894098b795ca2aaff7890f8aefc0aca453b384d38dd42c915729070388313b90bd74bb2b99dae23c8e174ffda3183b818aab39241f006c2839d9cb3372af054e81f967ce7706005475e29bcb2bd5a9148b71761c8554df88fa7f0c24b29294a462293843c7ca92880629d0c4027053e537856af558ed10035d4f06de1b1fff5c6e16f94b916e7b2ebd6c58f7ebc840aab4eea4eea4d43cc973bba05341378274c7750bf0ae1e14ce607b3b6444c7309bbc525bc7b2137ef0a8920af152ab46d69c91544e7cd8e180199d3eee05b683a0d04f789fc1ce51682a4a6395f5efc4f82ba849c36f1b99c28f671c044ace26abcd16a9a3515a92c1a14afb7b8e3df0d88e2feaecf40c53e49c6a170fa65fe54832452938b9ba97cf90f1db815453ec60f9fec663737485735866ce4250aced6863fadda971e3a31eeec634e118bd71849dd140258e674eaebe7e203b16d9f30c8b046f3b1879a1f7742ae99bfe390faa1ffd0663ae78f97baf3bcdaf4bd88a54d4daebc3542979c4dd31ec24f8b9d99f564121b3c5abd4cabf6ab041ab245d9f03f519f07c3e5a259fd3f318b6d65428816c842bc5c7ef6ecc2c9ca90d326a499ddd11b6e425aec08f0620ff30ec5f203c3f61f59205184dc40533216c6693feff8ccd32d8d41ef7c35d53f14d84da8d9ad2259a2570bc0da1249d16799b222a7ace349f47db3939f88402ce006c6c454d7c97f315e45fcaa1681055d882ee54cbfa2a73dc109850c001931bc4e5413b6bf134861d03009af76fb48cd803bf3c695b25f64892f7af6ce5d0bc85fa1403bdf28f20caa23f4cd7adca9d8a9288c52283159018830a6ac46156c951a8654bf7fb342b045fcf0c90cfe4496a40b266d015f8127da19bd89042aec01c53aad3c99bf678ed027763901196abbea2d1424a74cfaa0c8e63e9f611b11b0bca686171c091f1a4a5b5ef6f347dd4d1480c87f0787f68f30d3d939e58b754c7e3f81fec7836a3a1d03db22c5a42d00c679da30a8bc8d8a1f0139b3156284d0f7f0771f22a29906ac0d9eaae2a9f7dae74610ceff4ecf4afabf3e03885f85e71c178d16f30571a429e8e843034a39ccc5adb97b122f3360d7d98630cfca2a85eac3c03eaae65dfc03d4cbd462df3fd6d455e5a653f62a080bf924659913f3c65e60efa4e4ccb3fdbdf8e0db3af25433a123885f66dbc3b6071778bd8df9256bc98de579a009f7abdd04b2bca951ddb4ff8d2974582c9c478026140d5bc406282a27cd10c06c52037b4fe6cce212b411e0433ec8ad2f02467de0d3f5a741f1fc5a65fe2f0307bbd8481da099e9d03de6bab247d65d2b4660b06900c78052feed491bf205d877005ca19d74b7c56005d8189e8340a8c5f9bcf7d5f5316e6cc74a0abdb1ddf67d8797c88311a9e3034fdbde9c981fcfc39997b4f344e10e3b8cd87d6ecd4d702d57776ab214c6552680a70b1bf6c81de8ddb674b272fd9ce7a1b5ff8ff448dd4e846fde6e4f085ad1dbfe758abffd4e3b7328ad8bb19d52c23775ec80b51c9adf58b21ec2623a65e10a190e838a550659827d4fb3db51b8de575cdd6a3ab22d1fe571f7888cb029d44737f599d16dc5a10adca98c3de6e7bba4c004087a7c4a0e660c3440c64b684c90d0b39158d947186d20a3984f89c1785cb64af83bcd0ffb442ced721b1f7a858d4709a760cc3d53ec02c99d60bcced1306a9ee6cfe67a78b56de883692660ce6180558665df5c40eab19a9263a5b6299e016b83088913e9f44b84af9f7cfcbdbe542bfa851882a3d14bf2abaa708a6d5bda9813ac76e0b9454b5a9a8246d4d7e5a4ebee00159d2689b02c19718bcb06560a30ab92c33417767837737908352ef517d77c43a5a99292434f822b650d13d2c7c8a717eb74eac1db650e5b3ad73afa9280b7f59117c645416baa875b480da941b68d01914f2b88b10c3d75dc6f5035ae56cac4d140ea5ec2577b25bbf6b83cde742dda8fed74a1d232e2a4fc0a6d7344120f879e36c2d6df8165d1995fa1826d1ce5b0c17a31c6197e7751c31f0948e97e8d5d6083b5b2694735d2ad5213608c546a09db79fbaba964559e54f668409ca9a4815b4c9dd8e077c4b24354a6c46da282c7a2f2688c2ea4449580150214c56fbe61bd626ba728be2be0b86cd2f7aff38a1f7fcc9628b83265faed43ab7e5a01fc8f9eb16ced908e464eaa8a87462fd14aa92a98e7dbec3dc48da69c2d697e8f7becfde3fc27cbf505012ea2796da456ca38145dad95a6552f5a1837d0405c0cd123f7aca380374f3b81fe7ad09f62c2eb23c16854d66ad1402d60eef43ac1361a910d5a8ac5c9eba16adce0441f028af35378173e2baa986415391b0d987e101938d9989d3609e036c5a05f159b7462f8b09f84f799e53224ab8d2318d4892846f6e63035dc12ebfb1e1b97838fe672fa90525dd6c843a67c89ca087e8920fa2734bd76d95af07179e607a041cc2ef30e7c1744f415812a4dc27fd73aba4832d26ef5ea7f72ab1a54108f6e89aad4b37eaa7b245ec367e4df00ec0b3b0c6c153671aa8b58ef7f5f637ff6a6b9065774795b660c5b88cebce7bba94aba6043a785a413052b6c7164bf67641b6da627071e6b241df67d48db81a78f8e6d8cfb3d9a617071c4f7765eb68f2ef2a5d5a33ba9c68218cf071e147c4fb465c9f8779cfcbc7475cc9c180f13801d024d1891f51d40d3c8820cebf3c7752e3ae911d427730e5448b437ce2d049e9a2dcdb843e26105767e538b24695e49b8e76b3a76daede6701d2a267383566252262b1fd82128226c46b440b9495a09ac0c4c871b8289d8b75267e213dcd65a6d5ffdfddc51b982b4de2580534c047cca2991b4f529bfd20c9bb928cae32534b02e1b9e2156b686bfe8c730fd83624c35514cbfe6c7e7bdfa189cb80ddcad17f8947038f123b33d61478d10e6dc7ff860e217dfdcf47a6ee16e7c16c720adaeed253f3a75a4c589a7e2a81c6bdb593e8dce03edbd407adb4b20d1c9c2a08529e76870002fd068f2f2be2baa52c2e57a24a67e06b6d71801bf9e2fe091d98c1ed8793cbb1fd332eb1e523fa973b15c26fd3bdecf170993e6904e29a7b845bb2315090aef57e194ce5a4785f3f12f136745078042c5df382f4624c585a26b10ae84809aeb06e9e0b6f36112c51562874de626af1d6b87d806c21a011d2a3e2cd00a3de45ae3da73537dabfb22c6c29f5915da02ddd975913876603017df74c39508ff9db56a791c7e723adbcbe6a0b2f3bdae20d405b6e22029122fe9d56f864cc947a2587305283f2d92010524fddaf3814e9c42a20d3da6f4861db5302a1ba02397f9bf9e9118bfa02693f31c1c8212122d8d2bff30d11e400d980d11e68e53601c88c193ff81c0b0179fce201c4a6caf7a69e66fa2b96579bb3287c3d27de6d9fe1e65b7fb6abedc2e5ddae18fffbb0fea548ef50f49b95311f7ecaf8caf0de4d58e9f47c903521b0fbe60afe3d95c9668399b19cc546112d18bc2c347180ed68cc2744491d0156dd1fb7d0439acd70e99f4b59a75fdf9de85630a279ca583d0f25aa1c5d066abcfea40373e3e88a1a45657930d58bb28efb75c0f9e8f337d523a1dac8322211c0af8da8333ab3d3aee281dfd8640f81b2324f42afd36dc0022da3c95317bf50fb2114a0df2ef69ba7529ab6d5125eab5ba79b550c153e0a74897053a0ad5bf4ae3b5d161deb231db9ba90e1a9e2faa887d538452e3f7de0f27f52ec5f164a72ec8c7afef83ae10d6077398b35d2669678bb2f8b0e5a6393bb52109c2ce3512895c3d573bb6aa9efb497c286aacb8601a4fb5a1fd5991d2d294fee151d287432f50a6270506lmaoa961dc6189fcfc0085fb5df2c8c9fcf26f09876c1ceceffe92e58cd1228620a3b9389f486099ed43de05dc9aae1ab8eefb59a16087dd835ad6a7dca4de72083a5482bd99084da23f84747ee01d649a363737f055f7d6fa41b5948e2272cf7b7fbea2aedde9988e0c747656fe66015ddc6095fce5568cb7bd4382910b5d2161f7c29f999eece72ca36cec92929f23e7f9f1a433617a6fcfef5d13d035b91acf1d44ea3fe21a78526f3a897b8b263641f2571c2f4df73e6f0fc99ddcbca63070543950306a5bbc692e220946400f3c584698334bd8dae98d2da89c2ec4e77d4e605b3afa89102774525f7af456ad4cc5b6a526471ce068e43972d73bec934c185e144a958f687a0ff1f391d7e22acb9c056552cefbda0316785f5ce4983a0ee6a02fca4a0381c445307256d77871531a8b382e36e667dfe594c2bd62001838869f98216c027fcf1318801e715422b9134f57027b8bc80aad0623c0d2fffacffb7c5016153752ba4b9162ee6d4f4e38ecb4a8cc3683072411f4a4c63924c7a0e0c757455c77faece97a817c9ba0b218257f2f0666c73c97a55d12a7224343a846b858349394ff1d3e598d490422280ced85df5ca29b499aea068ea18ca0a7a51fbf4aa000efdc61e3f3f796f456be72ddcf7ca61ed2f55a7e885e26e69d872281c5b548f84caf4beca52f6886b60b1bc862b4768b149a9f16256d5ce3f782ada00e84e0dd83bc81226d96bece304b913ab596b681580d14048d5732535a783ffa961e0c7cb0047e16dc9e016fc83efb03a711697716e64d52c18266405f26b740a3894f4de243f6947d1b656249df122db3977f289a00fe75bbd47e7abf00c935e3a9b5058b6bb91311f7c496e4bf513c1b79846b36223f04392f0dc3067af6305af014988c9cc3ea3de05e966669156b5a8b6fee47aba25a935ff427fb6fd1b18536360e20f0a5672e2bdea627746bba3b73f58473fbc85a7cc05d8a4e3f5c73a393ea33112665c3290365a769cf9e8f520c3e4f99312e823c7d78cef660450bbee7de74c5520b96f1fb53d26edc540fcb77415928da0ff6cc89140d154013c941eb72e7a79e8348570010332e3db2dedf6b3610e24a84fe019d18a4fa01e1f94877df5dbd8df9a6ab5506269078e457fa0dc7c8202cd1e7f25a6e8242f151fdfc3a05aeae1416e29753d5763e6f7ec7429e69bd6b18350f2e0f0b36848cf47496fa4c14dd7c1bc02c6ef69c5ab1c22f09a5483180587318441f90173499301009993492f7cf2ece7c9020187e5b0688e2cb7c5589e3d5246d2c21f44bddf7825c8a92337bcffd8ba80df7c4a814b69789c28ac3ff1f1071c55273c70e89d1845d00504786371c18e25149b0e681d1b0cce63bdde06431746ef7a44106c906d54765ac728b07967b3c369cebfc1883c057e87ac3491ada4aea4304c9336e9a4bde88e11da50f4e842abbd129567f401d45bfe024c98161df67b6a07bb5082587ce04e2d5d5f10fb797cd178f74540b5a9fad7955b4086223039b756c38b2b6debff09048e06451461fd2ac4410c525706330059e2f2a3a3bbcab66ee79ea37ae29d292cac17b14b5b067ca7bb9c46fda9d19205a66d2d2600dda476481a04c8c1127dd9d090c6075dece3b3725f4a6ac99516e70dc2172515595142c32b81cacd74d49bf3deac8b670fb4d7feb09ecbf2c9517387eb72a9af1df468545be5d6f90ead642a3ae6ace032c497b12dcc8cbbeac40f143996a9b6d9d908bbf0f7f454591c42509053c233cebd2196e806d078c7246813d525230e5e354f73a89c7053171cfaa3e5aac9437ce0dee557b0644c70404e4f96672d7af3d1313ce08c938a9e0a5ed6cda137989c2c4fe01b96d68e897652ecb3c66be906b8941eba1c556685cfb544244343845df24e091c2177892f144701316a28944c9011e3c2725fac9ce69c6ec56f767d27414d025f2e2870030a51fd86a95b12ec615df8d2a2ef822b0a06c98d25032eb807ddaeff5d723bff2080e69e357cc3f6c7b9e03222c228ba9393d4ed5df38f6673a37d0e82c2fc453666c58c5b71ca91f267e781fc6b425aa5e2ef9d5a6b47dabc84059b92a4949cd86bde32e8c66e542e978ff151ba2c8370ffdf4d835ebd074c22e18ad799b1a5c451f5e823ff948252ff4136f69fee84ce002d3f399b74668a1188aba596899b921febc4efe2ddf996e62df302359c6917774ee61d0467fcd1551bafc5074ba25ad968a4910228b7caf1f049fefbb3ae41b8d4e70fd36dc95db2c647aa03418c2b9a1d899af20a7238e968aa8d0831c04e0fc46fa9985133c16e6477de905345b301a875dbc4d49419af6fb5e2e01d0aeeca543a501f39d0f0e2a3afa0104594cfd90077cc38ee1df60871264c11dcc3128d7f4196bdea3b75c25f44ddd928a2db2844ed7f4eb902bbcf3c435d13310ab2729fd16d4c5a6ff01b689f283c0c3411e6340d3d489a5b32faa748cc006f7333a2d4aa115d05fee7ceedc326af41a727443347a2c5584d06de8abf8b8be7963f2abbe42db4816eacbcad72755a29977ae41fede452600b535f266174aa2d0feddec544a8b28ca631c4c982aaa22d4daf95f14b852cce5c5d06f7b252afb8944e8ea02739498f80dafab9395b9b82102322d0e5e2366b5646b0be9cc683e2a07a8aecdfed34abd9cbe46bbff9d67c9b6f0d8724ff25bbd180d29faa1f7a5bc839167bb7dc9d31e845cf0e5dcc5f5059119fad04d3f0e732e037cfd624fc45cdac0b5d07db5fcf57a1ed69f008eb1bae402c1c2a7dc78d7ec183c82a625b1854a030319271fb2092eeac12e28858058df48f30b1e619be7eebc7ece30c94105c7d9f0de33e52e10fe4e4a48e0931e8bb1331409a1f80a16e7e4ff07ab5e9cd49965548af831fac2eb077079c75bf18f052eaeaa1b499a8a79419f5dbae5f241332df3a6c115649e94412ad3849a8fec30b78dd917b0a3a926f742ade1091a472bdde2d5b9ddd9df2e986ec3e1863357a6d3a291ff65fa531b856ca9618af280c5fe4c6f7c3d07c8713d6c785210bacda427eb2ccefda59e4cdfaf7835aa615c18a896d99beac05ff87c4b9f0577b5d678af78a91c17864d69bb51c12c8fcc963639f14d767ce19a57344d08cf13a2908bbca24039b76f54784dc5f4b6b3ca53ca9b40073c5a3cfc966ed37158ac80c1471e8b59db4c6c0ebf61777bd77e277fec6dd835694f9bf8c955fd3cfc3d2632c709cd6c9701b7e473f808c542d74bb2c6cf3efdacf96fe0549f112e567f8111b1562a179594c24cc6071753c6c2133f09a578384870d0fd42ce02a2b1085560dfee4c4e3668743f9d358c4080ac85557abd30df8f2c39d02a5447063b20d53a545057f8ad91c7271de33876de0d78c892371e5dd407d865337af0f49f48c63c209356e1d094477fb3d4c67a5fee717f62cb32e313f87f7c1aa469bff875fa701db84ef4f0295e340b8b42c0c57d2e62c8d00d6ca316c3b96129ebcccbbe30459afd3419bbf2eed3d43fd4e796957aa282ad03348d755d269a4f3e7a6760bc293a0a2bb0f4a21597b90a3f532a1151ef88df91320439e01e0595996d28fea9da3f8dc44c931cc30f8fba2479aa5dcd3bb3e9dde89abf71a3ef30cce9804d927ec00381ce9f209631c93154ba44dcf439ec18fc7c9be18b8ab5d72e1b05c49e844087b91d8f6f6d2d8d1e4a6125f8a4c904faf21d67048ee25bf358c0102415d57dc5f26dd225e0f108f26b800ef52c641d083dd0ee0a69b0e52aeba619d419d0f2df9f25e155c6d10f77b5eb119dbe4ed52d64c6a0e0043a88ac4299c8d264eed9476a9052b78fe4091f82bce6e404c8e70412441b0041fe986d4a2043e5d7f5fd2036cb16bee530f7d45863b82ad1e91f6bc63cb2bccce08969ea2b67a5d5238132423b6b254a4fc5d23a6f713cff415355c29381f3aff9196aa93d0bb07c82d1658a44ff0145965fb8b4e8b83458443a9efca15c1a0fce3a77cf2cfe14e169c68e4963e829dd8c045f4e4750e59171eef0804f9f85d0bbc50e971b61c410af74a31c9600754cdcdccb6d97ace8b28ab4e763d033ff0fb2951308055b1b0502b46bcf8a57805a750182da196c811f758a90acf1da0e9b7e2b98c5964577cd0f4ac74a4425578e55ebfae5eeb78b40a2cc5334fce978291ac05c7e582b61bc870e2e7e23201ce9b29e995933bfe08c36cbb114b096d2609989bd3637c651372dd89091a8cac3954a3ffeb702a6527e834fee55fcc1eddce6569f974bff96ece3f37af41d87a72a7baec33288cd0379de9e95c6074c9a6c3f6ce9df7fc5b2e95d2c5da75040532e0f3f09c6bf7f37119f4c9336f044fad26f4a451dd08eef535182aa3f6e43798cfece8c3c720288c06893ee2a5a17bbc6f417c3f110e32556cd4ec3e5dcaafd9dda267e0042746d3a4918ea171b0410149ea8648e9b7f4585bebf4e351021eaad7fec3412d361dfeeb00bc65c99e4e96ac6f0bc7379971954a9d0b42102928faa3bf09f0e5563a432af870f7b27e1baaa0230d77fef75cf38dd18b99126bde8f8b185af7202c3faeb19d3aa32795c7687c19c1cf7673ec58bedfe99d3ecb899fc240ba726279a9c322df4956356da99537cdaf10caa59cbb55b8e2dd109fc08e21667f59a13a7a97eabcf200d4b04b1e9c7dc25aaebe27bb498435e6b787613c8707ae46dbfef4bcb2e0b1e59eafb7bd4715365b5250958f4258e4936be6c74b0fe29bacce1b79605f61eee25fffad4eb324a3ee545c63b9a665004cf37d223b3ecb0f90ad50d228f6b988d5db25c2dad826927505428edeb538b5bbb55412130603eebd6cf50ee75c81195f228990d1410843b18e689b3ad945ff520c622accfede8e34f52740ad28b34e421675014379c587d9ea30b63af9783623159fd064718dbb1ef4d18011edabc5326a9119935268b7ca2ebcff0300ddd35b965a401b83a2fa54936070ed213c7807d3f8a415f11792cafe5a926f8e715d84a32d9b3ba440c27f63a19903d48593eaa00face71f54fdf4afcffe53844e0744195bab65fbaf90f0c4e76d3e9501b60384ad1cee941127a90ce1316dc13cd5094ed7f8c61d6733979440dbf9969c3bb16460d95ae2e2480c57303f2a1880155b96a91a142546058333bc8e982b43f653e1b367bfe729481de649a6e502b6d9965e864ed6804a0b12bcf37247e4bf3af15c0c01a064d06580852b5085b5d1556505f490caf1e380d5a8e30b075f0d5f722a8704e33452761b5c48e4958d13ed8b8ac7a7171e32f95e83633faf8f240b66af87c559435a65494c6350e3f3cb7d2ff14e0f824d6518ae5abc80ac387c171913684c341e6e304c38d7d5e1cc2429de2c5d6450fad42dc02524f43993014e19bedd4c7e652976fc748d32c76b660b483b18d2a6e0a2f64f2555a88dcc27f6b0dbb55e7dba0cf272dafe6e7b53b8fdcfa62308819aee3f755373b157f9147edd8493624c2714da47b687abb4d409388fd239d5e8b49e379f92edad08c50336c436fc8650d0835918ac8c9ae62886ce00bf2cce1b631e44962bc65d37596e408d91d07c2d38fe1862346efe6e4f1cd9240fc5dc8ba02991efd9ba6cb7497e7f09a409bdae632520cefa133b5dc1b0bc57af7700383ea6ce82086a95605000395d9a50de956dc9c11fb678349f51f093926c5918de7de409c2fec9dd616649bf1f15186067148b856c8c85d05faf5c841cb19c5ec2b3c3709fa285479b04b8cad074c421e9e6145f48f8acf085d6a74c8f0a742bd2ee1e69b6172297aa254a00f2553537953bef428cf7ac85ea3282dd0b4d845042320741a1bc2441e6a1c7c4ea214529c6cfe6b4d07e59dc55f0e72b34279f4708244cd3aff06c582447f071706d746f251b959a4b4115e3e93b2bfae523ae6bd5bc48c4262587c55346347cc7e03e79890b87da760bb06c8216a81b6613530a7f43fd42f44a7d79af9b34d93aeaf104132004250f91d14c85545bc6738762751a6df5d830804bf68bea5f5b8802d06077bd71a2647f5cbeaf0e6bb1d76d22f7e07de7a9a8a7d7504903f956703341f30979d0748f66fb871f39e65404f6ed8bea4a5bf760eb3562dbf4bd4e5671e0a568730b3d696a4ba12aa0a0263ad37284749fefc8c776f7ead8b38809d76dc78fa10193920f2cd10146d714f59e5d673760c8d04d6041de28de719a4da4ffab4c7d9d4a778c0570a717256ef6d41ed9fb6c30397975ff8503a47d7ad52e682dcf9c55d9a41960694c80828131d6a067fd2b94797039ea220321cfa944731aa606e6044ae7b5afc5c6dbe934b658107cab019c91cc1eda91f0f9307d22f38e4e3c6b9aa4a2b4d4be2e3db855c3d5925b5bbd1d9cb8038074d3e84a2e4a58cce1370cb07f667ab8e4d2c8f96a0d1b470821af922fc9accf5c41dd38abc78ace183a298f47e8691ebdad277016ef2f9fc663ec3a0e67be462983eee38a7dbd75ee87d122e1f3a5e20f601ddaaf4dc8835bbf29326d9622c026e582aeb4f87a39ec5572c2672e8847c07023b49cf3ca18d10226f287f53777a6380d01064d7bf863b65f3a35af551882ff4ea690846c3f3649ade8ffb2f281ccf13478c2d4e052f8e654bd12bd3b0c37f70b88a78756879fd2bbe3d2c9015c97358ee1a88fd0b76dab9dce728ccf4b0b3ec454c055ff45e355b2afd36de5dfc2fcf19aa18019c72c4a08b7eb6d9aa363b4ef2f7e2defda3d418c4a88eb837e631ff763829f466401c486ade8d9455bc29ffb0dc88ca913c53a84d5fb0ddb56a48303da97f96fba04cecd8f1c074041e50df83a121c1307689236b9df91623f96f584bd60ae15ea0dbf403b5a667f27d6f6668fd59062ba387abb813e17a32e6c9f8e1925b5074d0c8fb00c660b0950b755c71384cd82f9eb16366cd306fea5efae6dd4dc856c4f53b4d004980efd9da13b99ef318ecd3f208d9998c9615ff762aa6a1d91cab95d031939270267ee3399794f04d99dd9db2235e3f89941279068daa40c36537d0633967fac672d1b1a5a5a95672d0dbc35538dcc0afa1123b5e560b6f32b652c3e187e3a6d10e6bc52129ef5631c0f940c87f59f28f2a879a3c7a945be0420ac7c088d7bf1d749d6653504cb043f21079fa274a48d5cbd1945f8d85c13596be120119cd4c01bd0889cc8746c5646c0cc3afe585bd1696945e8e0c79436c40f4492f7fff3446eae76f3b21c0c1390b6ece746dec71b7120e53fc1e1c99d74ec84bd9e0cc5ee59dbf99642acd7f85e716c81e9e760a0b4fb5c9edd0625317b00fc131eff2db4a5135e330568db0e122371183c2119b8f6b05693b53baf4a8767ceae85893c90b664359d233af11a560047d08431808a99651bd3de26d6a148f218b31ac15ab1a41b23aad9a469ef05785aa6861df8928470ee5445741ccd589aa18ce3f515b4bc4c5f376789d76d2274c663cd76fe3dc8d59f0c8ffc66168545df72a4a5ebfd7285789a789d2635435bea96b27ffa1a988426af1e77edb221d6ddb336b7caf691ac66ca578049c7a87e9e166c2ac17fa6d110403ff55d91037779fd1c41886398939ba730f0b3b94cd7f68762fedf441c9e10f22a8c93a48a20072b076fcaa9f00149557eec4b382aa1efb59c126fa1856ad63143b846cd8e3c6ad5c75f7388f2f9efd97a7b70c06c0d965b9131e5a008b224b02ef120cb362bbe11cd3ed6619a260e5f136ae8b15bf168bfda7a2e733bc6c4866d5e48f33814f1188d4bbc6f2918b57bd714a65d67b66c19aea92eddffcc53c5b71b41f570ee6ea39cb02c5444162e97220a82047fb8c5e2e0d1192acbc771c9472d2c02be5f71fab9dbffd84d417c592678d7de2ae9eb2903dfa230547512516235e6b2749a1eb7205897c14161568defd99823849abc8a35207d6333cebaec7fbf04c83887f670534034a9a112855d53b19984cbeba8db505bd7e7fadc4b2fcc00cddc30fc8ea348bbcc8c54b632a84bbed801d7b3c0d8b8b56c94ccab4a15c4863b398a39bf7f3231da816de9ca2442dd5f610421c5ae1f678aecb71bee73c3374bbe0d98826207e22223fb3bc24965a9e1247900b645a36b3d39b2d3e48b624a164d8959b3c79b00751c3890871d3d8f3de55c5f971e4353ffa5acf3b752cae2c12ae96c997630f28a0746f0ace81335f465533dae1ea51ba9d132235bd8f1066394a365b1948c1f6a1cdaec1d9a6c14e8776d391bd3dcf27ff87a47182f6504d1ecfe566faddda672abdb2991e5b755c591c28edb3db54c59bab8e805d2b15d28b39b8602445c4a0ebbd1b6adf18e5742d4f5953792634e860360cf9936199f989f1e4ae65e75cd8443cd4973eff78c418b146e4155c33d977f8ca4e30b2e52cc8c8de3884545752ad2a4c36ea69ec07d638a664acc69fc4c9ce1fd30975587ead31ccd7c4ba791fa57e3610995f437332b0c5c48580a582986c1c9891cdeccf876655ea965a51e35ff045d685c23e365876df4c58e88882d581effac3b9effadf9ce2deeeebd18fb6a16e691a22c869c5da3cc0e2979f301a7eb6305cee3228300e673fc47cf2726e739b617e49a11f50e85bdb68df2fc876410a7cf661370ba63ab11ae13299cc27f5530753820c*$/pkzip2$:dummy.pdf:blueprints.zip::/home/ben/Desktop/HTB/Academy/Cracking with Hashcat/blueprints.zip
```

We can see from that hash that this is mode `17200 - PKZIP (Compressed)`. To run this through `Hashcat`, we need the entire hash starting from `$pkzip2$1` and ending with `/pkzip2$`. Armed with the hash, let's run it with `Hashcat` using a straight dictionary attack.

```shell-session
alakin2504@htb[/htb]$ hashcat -a 0 -m 17200 pdf_hash_to_crack /opt/useful/seclists/Passwords/Leaked-Databases/rockyou.txt

hashcat (v6.1.1) starting...
<SNIP>

$pkzip2$1*2 <FULL HASH SNIPPED> k*$/pkzip2$:zippyzippy
                                                 
Session..........: hashcat
Status...........: Cracked
```

## Example 3 - Cracking Password Protected KeePass Files

It is not uncommon to find KeePass files during an assessment, perhaps on a sysadmin's workstation or on an accessible file share. These are often a treasure trove of credentials because systems administrators, network administrators, help desk, etc. may store various passwords in a shared KeePass database. Gaining access may provide local administrator passwords to Windows machines, passwords to infrastructure such as ESXi and vCenter, access to network devices, and more.

We can extract these hashes using the compiled version of the [keepass2john](https://github.com/magnumripper/JohnTheRipper/blob/bleeding-jumbo/src/keepass2john.c) tool or using the Python port done by [HarmJ0y](https://gist.github.com/HarmJ0y), [keepass2john.py](https://gist.githubusercontent.com/HarmJ0y/116fa1b559372804877e604d7d367bbc/raw/c0c6f45ad89310e61ec0363a69913e966fe17633/keepass2john.py). `Hashcat` supports a variety of compressed file formats such as:

`Hashcat` supports the following hash names for KeePass databases, all designated by the same hash mode:

|**Mode**|**Target**|
|---|---|
|`13400`|KeePass 1 AES / without keyfile|
|`13400`|KeePass 2 AES / without keyfile|
|`13400`|KeePass 1 Twofish / with keyfile|
|`13400`|Keepass 2 AES / with keyfile|

We can use `keepass2john.py` to extract the hash:

#### Extract Hash

```shell-session
alakin2504@htb[/htb]$ python keepass2john.py Master.kdbx 

Master:$keepass$*2*60000*222*d14132325949a3b4efacdb2e729ec54403308c85654fe4ababccfb8ddc185d09*5c09bed9c98f8ee08aa7a71fe735b30849ec87e6cb7f1caa96d606ce9f077f7e*bd372d79d8aceea9689ad49428b8efde*28d21caedf25617db0833bd721a42c963e874e0b9fbe7fe1187a4a8ecb3b1d19*a539abd3cfd7ee5982fa28c44dd226ce05a1102d04a5f590eabf5138cd2a6403
```

From the output, we can see that this is indeed a KeePass hash, and the type is `KeePass 2 AES / without keyfile`. With the hash in hand, we can attack it with a `Hashcat` dictionary attack. This hash uses the [AES](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard_process) cipher, which is more difficult to crack and runs slower through `Hashcat` than other hashes such as `MD5` or `SHA1`. Therefore a very complex password may be difficult to crack, but a password contained within a wordlist such as `rockyou.txt` could take around 8 hours to crack on a single CPU but would crack exponentially faster on a GPU cracking rig.

#### Hashcat - Cracking KeePass Files

  Cracking Miscellaneous Files & Hashes

```shell-session
alakin2504@htb[/htb]$ hashcat -a 0 -m 13400 keepass_hash /opt/useful/seclists/Passwords/Leaked-Databases/rockyou.txt

hashcat (v6.1.1) starting...
<SNIP>

$keepass$*2*60000*222*d14132325949a3b4efacdb2e729ec54403308c85654fe4ababccfb8ddc185d09*5c09bed9c98f8ee08aa7a71fe735b30849ec87e6cb7f1caa96d606ce9f077f7e*bd372d79d8aceea9689ad49428b8efde*28d21caedf25617db0833bd721a42c963e874e0b9fbe7fe1187a4a8ecb3b1d19*a539abd3cfd7ee5982fa28c44dd226ce05a1102d04a5f590eabf5138cd2a6403:1qazzaq1
                                                 
Session..........: hashcat
Status...........: Cracked
```

#### Extract Hash
```shell-session
alakin2504@htb[/htb]$ python pdf2john.py inventory.pdf | awk -F":" '{ print $2}'

$pdf$4*4*128*-1028*1*16*f7d77b3d22b9f92829d49ff5d78b8f28*32*d33f35f776215527d65155f79d9ed79800000000000000000000000000000000*32*6cfb859c107acaae8c0ca9ceec56fd91ff75fe7b1cddb03f629ca3583f59e52f
```

`Hashcat` supports a variety of compressed file formats such as:

|**Mode**|**Target**|
|---|---|
|`10400`|PDF 1.1 - 1.3 (Acrobat 2 - 4)|
|`10410`|PDF 1.1 - 1.3 (Acrobat 2 - 4), collider #1|
|`10420`|PDF 1.1 - 1.3 (Acrobat 2 - 4), collider #2|
|`10500`|PDF 1.4 - 1.6 (Acrobat 5 - 8)|
|`10600`|PDF 1.7 Level 3 (Acrobat 9)|
|`10700`|PDF 1.7 Level 8 (Acrobat 10 - 11)|

We can crack the hash with mode `10500`.

#### Hashcat - Cracking PDF Files

  Cracking Miscellaneous Files & Hashes

```shell-session
alakin2504@htb[/htb]$ hashcat -a 0 -m 10500 pdf_hash /opt/useful/seclists/Passwords/Leaked-Databases/rockyou.txt

hashcat (v6.1.1) starting...
<SNIP>

$pdf$4*4*128*-1028*1*16*f7d77b3d22b9f92829d49ff5d78b8f28*32*d33f35f776215527d65155f79d9ed79800000000000000000000000000000000*32*6cfb859c107acaae8c0ca9ceec56fd91ff75fe7b1cddb03f629ca3583f59e52f:puppydog1
                                                 
Session..........: hashcat
Status...........: Cracked
```