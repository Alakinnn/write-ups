# Dictionary Attack
There are many sources for obtaining password lists such as [SecLists](https://github.com/danielmiessler/SecLists/tree/master/Passwords), a large collection of password lists, and the `rockyou.txt` wordlist, which is found in most penetration testing Linux distros.

We can also find large wordlists such as [CrackStation's Password Cracking Dictionary](https://crackstation.net/crackstation-wordlist-password-cracking-dictionary.htm), which contains 1,493,677,782 words and is 15GB in size. Depending on needs and computing requirements, there are much larger wordlists made up of cleartext passwords obtained from multiple breaches and password dumps, some equaling over 40GB in size.

## Straight or Dictionary Attack

As the name suggests, this attack reads from a wordlist and tries to crack the supplied hashes. Dictionary attacks are useful if you know that the target organization uses weak passwords or just wants to run through some cracking attempts rather quickly. This attack is typically faster to complete than the more complex attacks discussed later in this module. It's basic syntax is:

```shell-session
alakin2504@htb[/htb]$ hashcat -a 0 -m <hash type> <hash file> <wordlist>
```

For example, the following commands will crack a SHA256 hash using the `rockyou.txt` wordlist.

  Dictionary Attack

```shell-session
alakin2504@htb[/htb]$ echo -n '!academy' | sha256sum | cut -f1 -d' ' > sha256_hash_example
alakin2504@htb[/htb]$ hashcat -a 0 -m 1400 sha256_hash_example /opt/useful/seclists/Passwords/Leaked-Databases/rockyou.txt

hashcat (v6.1.1) starting...

<SNIP>
```

```shell-session
alakin2504@htb[/htb]$ hashcat -a 0 -m <hash type> <hash file> <wordlist>
```

For example, the following commands will crack a SHA256 hash using the `rockyou.txt` wordlist.

```shell-session
alakin2504@htb[/htb]$ echo -n '!academy' | sha256sum | cut -f1 -d' ' > sha256_hash_example
alakin2504@htb[/htb]$ hashcat -a 0 -m 1400 sha256_hash_example /opt/useful/seclists/Passwords/Leaked-Databases/rockyou.txt

hashcat (v6.1.1) starting...

<SNIP>
```

# Combination Attack

Using awk to combine entries
```shell-session
alakin2504@htb[/htb]$ awk '(NR==FNR) { a[NR]=$0 } (NR != FNR) { for (i in a) { print $0 a[i] } }' file2 file1

superhello
superpassword
worldhello
wordpassword
secrethello
secretpassword
```

#### Hashcat - Syntax

The syntax for the combination attack is:

```shell-session
alakin2504@htb[/htb]$ hashcat -a 1 -m <hash type> <hash file> <wordlist1> <wordlist2>
```

# Mask Attack
|**Placeholder**|**Meaning**|
|---|---|
|?l|lower-case ASCII letters (a-z)|
|?u|upper-case ASCII letters (A-Z)|
|?d|digits (0-9)|
|?h|0123456789abcdef|
|?H|0123456789ABCDEF|
|?s|special characters («space»!"#$%&'()*+,-./:;<=>?@[]^_`{|
|?a|?l?u?d?s|
|?b|0x00 - 0xff|

---

The above placeholders can be combined with options "`-1`" to "`-4`" which can be used for custom placeholders. See the _Custom charsets_ section [here](https://hashcat.net/wiki/doku.php?id=mask_attack) for a detailed breakdown of each of these four command-line parameters that can be used to configure four custom charsets.

Consider the company Inlane Freight, which this time has passwords with the scheme "`ILFREIGHT<userid><year>`," where userid is 5 characters long. The mask "`ILFREIGHT?l?l?l?l?l20[0-1]?d`" can be used to crack passwords with the specified pattern, where "`?l`" is a letter and "`20[0-1]?d`" will include all years from 2000 to 2019.

Let's try creating a hash and cracking it using this mask.

#### Creating MD5 hashes

```shell-session
alakin2504@htb[/htb]$ echo -n 'ILFREIGHTabcxy2015' | md5sum | tr -d " -" > md5_mask_example_hash
```

In the below example, the attack mode is `3`, and the hash type for MD5 is `0`.

#### Hashcat - Mask Attack

```shell-session
alakin2504@htb[/htb]$ hashcat -a 3 -m 0 md5_mask_example_hash -1 01 'ILFREIGHT?l?l?l?l?l20?1?d'

hashcat (v6.1.1) starting...
<SNIP>

d53ec4d0b37bbf565b1e09d64834e1ae:ILFREIGHTabcxy2015
                                                 
```

	The "`-1`" option was used to specify a placeholder with just 0 and 1. `Hashcat` could crack the hash in 43 seconds on CPU power. The "`--increment`" flag can be used to increment the mask length automatically, with a length limit that can be supplied using the "`--increment-max`" flag.

# Hashcat - Hybrid mode
#### Hashcat - Hybrid Attack using Wordlists

```shell-session
alakin2504@htb[/htb]$ hashcat -a 6 -m 0 hybrid_hash /opt/useful/seclists/Passwords/Leaked-Databases/rockyou.txt '?d?s'

hashcat (v6.1.1) starting...
<SNIP>
```

Attack mode "`7`" can be used to prepend characters to words using a given mask. The following example shows a mask using a custom character set to add a prefix to each word in the `rockyou.txt` wordlist. The custom character mask "`20?1?d`" with the custom character set "`-1 01`" will prepend various years to each word in the wordlist (i.e., 2010, 2011, 2012..).

#### Hashcat - Hybrid Attack using Wordlists with Masks


```shell-session
alakin2504@htb[/htb]$ hashcat -a 7 -m 0 hybrid_hash_prefix -1 01 '20?1?d' /opt/useful/seclists/Passwords/Leaked-Databases/rockyou.txt

hashcat (v6.1.1) starting...
<SNIP> 
```